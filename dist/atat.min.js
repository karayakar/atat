/*! atat 2017-12-28 */

!function(){"use strict";function a(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function b(a,b,c){var d=this;try{t(F(a,b.inline),function(a,c,e,f){try{if(a.name==L)return b.parts.push(a.value),void f(null,"this.output += this.parts["+(b.parts.length-1)+"];");if(a.name==M){var g=a.left,h=a,i=a.right;if(""==h.value.trim())return void f(null,"");var j=b.compiler(g.value+h.value+i.value);return j?void j.call(d,h,b,f):void l.call(d,h,b,f)}}catch(a){f(a)}},function(a,b){if(a)return c(a);c(null,b.join(""))})}catch(a){c(a)}}function c(a,b,c){c(null,a.value.trim())}function d(a,b,c){var d="for("+a.value+"}",e=B(d,/\{/g,/\}/g),f="";f+=e[0].value,f+="{",this.compile(e[1].value,b,function(a,b){if(a)return c(a);f+=b,f+="}",c(null,f)})}function e(a,b,c){c(null,a.left.value.trim().substring(1)+a.value.trim()+"}")}function f(a,b,c){var d=this;t(B("if("+a.value+"}",/\{/g,/\}/g),function(a,c,e,f){if(a.name==L)return f(null,a.value);d.compile(a.value,b,f)},function(a,b){if(a)return c(a);c(null,b.join(""))})}function g(a,b,c){try{""===a.value.trim()&&c(),c(null,"this.output += this.helpers.encode("+a.value.trim()+");")}catch(a){c(a)}}function h(a,b,c){try{""===a.value.trim()&&c(),c(null,"this.output += ("+a.value.trim()+");")}catch(a){c(a)}}function i(a,b,c){try{if(b.__layout)return c();K.compileUri(w(a.value),b.options,function(a,d){if(a)return c(a);b.__layout=d,d.__context.parent=b,c()})}catch(a){c(a)}}function j(a,b,c){try{var d=a.value.trim();if(""==d)return c(new Error("Partial parsing error"));var e=d.split(/\s*,\s*/g),f=w(e.shift());K.compileUri(f,b.options,function(a,d){if(a)return c(a);b.__partials.push(d),d.__context.parent=b;var f="this.output += this.__partials["+(b.__partials.length-1)+"]("+e+");";c(null,f)})}catch(a){c(a)}}function k(a,b,c){try{var d=w(a.value),e="this.output += (function(){var s = this.section('"+d+"'); return s?s("+b.arguments+'):"";}).call(this);';c(null,e)}catch(a){c(a)}}function l(a,b,c){try{var d=a.left.value.substring(1,a.left.value.length-1);if("function"!=typeof b.helpers[d])throw'Helper "'+d+"\" didn't declarated";c(null,"this.output += this.helpers."+d+"("+a.value.trim()+");")}catch(a){c(a)}}function m(a,b,c){var d=a.value.trim(),e=a.left.value.trim(),f=D(e,/^@section\s+([A-Za-z0-9]+)\s*\{/g);if(!f||f.length>2)return c(new Error("Section parsing error"));var g=f[1].trim();if(b.__sections[g])return c(new Error("Section already exists"));K.compile(d,b.options,function(a,d){if(a)return c(a);d.__context.parent=b,b.__sections[g]=d,c(null)})}function n(a,b,c){var d="while("+a.value+"}",e=B(d,/\{/g,/\}/g),f="";f+=e[0].value,f+="{",this.compile(e[1].value,b,function(a,b){if(a)return c(a);f+=b,f+="}",c(null,f)})}function o(a,b){var c=new XMLHttpRequest;c.open("GET",a,!0),c.onreadystatechange=function(){4===this.readyState&&(this.status>=200&&this.status<400?b(null,this.responseText):b(new Error('Not able to load template "'+a+'"')))},c.send(),c=null}function p(a){var b=[];return s(a,function(a,c){b.indexOf(c)===-1&&b.push(c)}),{open:new RegExp(b.join("|"),"g"),close:/}@/g}}function q(a){var b=[];return s(a,function(a,c){b.push(c)}),b.push("(@[A-Za-z0-9$]+\\()([^]*?)(\\)@)"),new RegExp(b.join("|"),"g")}function r(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").toString().replace(O,function(a){return N[a]||a})}function s(a,b){if("[object Array]"===Object.prototype.toString.call(a))for(var c=0,d=a.length;c<d;c++)b(a[c],c,a);else for(var e in a)a.hasOwnProperty(e)&&b(a[e],e,a)}function t(a,b,c){for(var d=0,e=!1,f=[],g=a.length,h=0;h<g;h++)b(a[h],h,a,function(a){return function(b,h){if(!e){if(b)return e=!0,void c(b);f[a]=h,d++,d==g&&(e=!0,c(null,f))}}}(h))}function u(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};for(var c in a)!b.hasOwnProperty(c)&&a.hasOwnProperty(c)&&("object"==G(a[c])?b[c]=u(a[c]):b[c]=a[c]);return b}function v(a){for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];if(0==c.length)return String.prototype.trim.call(a);for(;c.indexOf(a.charAt(0))>=0;)a=a.substring(1);for(;c.indexOf(a.charAt(string.length-1))>=0;)a=a.substring(0,a.length-1);return a}function w(a){return v(a).replace(/^"(.*)"$/g,"$1").replace(/^'(.*)'$/g,"$1")}function x(a){return JSON.stringify(a)}function y(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return Array.prototype.join.call(a,b)}function z(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").toString().toUpperCase()}function A(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").toString().toLowerCase()}function B(a,b,c){for(var d=b.global,e=b.sticky,f=[],g=0,h=0,i=0,j=0,k=void 0,l=void 0,m=void 0,n=void 0;;){if(m=D(a,b,i),n=D(a,c,i),m&&n&&(m.index<=n.index?n=null:m=null),m||n)h=(m||n).index,i=h+(m||n)[0].length;else if(!g)break;if(e&&!g&&h>j)break;if(m)g||(k=h,l=i),++g;else{if(!n||!g)throw new Error("Unbalanced delimiter found in string");if(!--g&&(k>j&&f.push({name:L,value:a.slice(j,k),start:j,end:k}),f.push({name:M,value:a.slice(l,h),start:l,end:h,left:{value:a.slice(k,l),start:k,end:l},right:{value:a.slice(h,i),start:h,end:i}}),j=i,!d))break}h===i&&++i}return d&&a.length>j&&f.push({name:L,value:a.slice(j),start:j,end:a.length}),f}function C(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;b.lastIndex=c;var d=b.test(a);return b.global&&(b.lastIndex=d?b.lastIndex:0),d}function D(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;b.lastIndex=c;var d=b.exec(a);return b.global&&(b.lastIndex=d?b.lastIndex:0),d}function E(a){for(var b=0;b<a.length;b++)void 0===a[b]&&(a.splice(b,1),b--)}function F(a,b){for(var c=b.global,d=b.sticky,e=[],f=0,g=0,h=void 0,i=void 0;;){var j=D(a,b,f);if(null==j)break;if(g=j.index,d&&g>f)break;if(E(j),h=g+j[1].length,i=f+h+j[2].length,g>f&&e.push({name:L,value:a.slice(f,g),start:f,end:g}),e.push({name:M,value:j[2],start:h,end:i,left:{value:j[1],start:g,end:h},right:{value:j[3],start:i,end:i+j[3].length}}),f=g+j[0].length,!c)break}return c&&a.length>f&&e.push({name:L,value:a.slice(f),start:f,end:a.length}),e}var G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},H=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),I=function(){function c(){a(this,c)}return H(c,[{key:"compile",value:function(a,c,d){var e=this;try{t(B(a,c.tags.open,c.tags.close),function(a,d,f,g){try{if(a.name==L)return""==a.value.trim()?void g(null,""):void b.call(e,a.value,c,g);if(a.name==M){var h=a.left,i=a,j=a.right,k=c.compiler(h.value);return k?void k.call(e,i,c,g):void b.call(e,h.value+i.value+j.value,c,g)}}catch(a){g(a)}},function(a,b){if(a)return d(a);d(null,b.join(""))})}catch(a){d(a)}}}]),c}(),J=function(){function b(c){var d=this;a(this,b),this.options=u(K.options,c),this.output="",this.model=null,this.helpers=this.options.helpers,this.parts=[],this.arguments=[this.options.modelname,this.options.helpersname,"body"].join(","),this.tags=p(this.options.tags),this.inline=q(this.options.inline),this.tags.compilers=[],s(this.options.tags,function(a,b){d.tags.compilers.push({compiler:a,regexp:new RegExp(b,"g")})}),s(this.options.inline,function(a,b){d.tags.compilers.push({compiler:a,regexp:new RegExp(b,"g")})}),this.__layout=null,this.__partials=[],this.__sections={},this.parent=null}return H(b,[{key:"section",value:function(a){return a?this.__sections[a]||this.parent&&this.parent.section(a):null}},{key:"compiler",value:function(){for(var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",b=0,c=this.tags.compilers.length;b<c;b++){var d=this.tags.compilers[b];if(C(a,d.regexp))return d.compiler}return null}}]),b}(),K=function(){function b(){a(this,b)}return H(b,null,[{key:"compileUri",value:function(a){var c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};"function"==typeof c&&(d=c,c={}),b.fileLoader(a,function(a,e){if(a)return d(a);b.compile(e,c,d)})}},{key:"compile",value:function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};"function"==typeof b&&(c=b,b={});var d=new J(b);(new I).compile(a,d,function(a,b){if(a)return c(a);var e=new Function(d.arguments,b+";return this.output;");d.template=function(a){try{d.output="",d.model=a||d.model;var b=e.call(d,d.model,d.helpers,d.body);return d.__layout&&(d.__layout.__context.body=b,b=d.__layout(d.model)),b}catch(a){return a.toString()}},d.template.__context=d,c(null,d.template)})}}]),b}();K.fileLoader=o,K.options={modelname:"it",helpersname:"$",tags:{"@\\{":c,"@if\\s*\\(":f,"@while\\s*\\(":n,"@for\\s*\\(":d,"@function\\s+[$A-Za-z0-9]*\\s*\\(":e,"@section\\s+[$A-Za-z0-9]*\\s*\\{":m},inline:{"(@section\\()([^]*?)(\\)@)":k,"(@layout\\()([^]*?)(\\)@)":i,"(@partial\\()([^]*?)(\\)@)":j,"(@\\()([^]*?)(\\)@)":g,"(@!\\()([^]*?)(\\)@)":h},helpers:{encode:r,json:x,join:y,upper:z,lower:A}};var L="outside",M="inside",N={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},O=/&(?!#?\w+;)|<|>|"|'|\//g,P=function(){return this||(0,eval)("this")}();if(void 0!==P){var Q=P.Atat;K.noConflict=function(){return P.Atat=Q,K}}"undefined"!=typeof module&&module.exports?module.exports=K:"function"==typeof define&&define.amd?define(function(){return K}):P.Atat=K}();